---
layout: post
title: "ใช้ parse ทำ cronjob ง่ายและฟรี"
date: '2015-02-27T09:59:00.002+07:00'
author: Pakkapon Phongthawee
tags:
- "สอน"
- คอมพิวเตอร์
modified_time: '2015-09-27T19:23:40.293+07:00'
thumbnail: https://2.bp.blogspot.com/-CCPLPE8n_Dk/VO_WN1Rb1qI/AAAAAAAAYF4/u5XICxhYw7M/s1600/parse.png
blogger_id: tag:blogger.com,1999:blog-3103072889085475591.post-3147698623900843074
blogger_orig_url: http://www.pureapp.in.th/2015/02/use-parse-as-cronjob.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-CCPLPE8n_Dk/VO_WN1Rb1qI/AAAAAAAAYF4/u5XICxhYw7M/s1600/parse.png" imageanchor="1" ><img border="0" src="https://2.bp.blogspot.com/-CCPLPE8n_Dk/VO_WN1Rb1qI/AAAAAAAAYF4/u5XICxhYw7M/s1600/parse.png" height="128" width="320" /></a></div><div class="separator" style="clear: both; text-align: left;">ถ้าท่านไหนเคยใช้ Heroku หรือ Openshift จะพบว่าเว็บที่ให้บริการ cloud app แบบนี้จะมีสิ่งที่เรียกว่า App idle ซึ่งจะทำให้แอปคุณไม่สามารถทำงานได้ เมื่อไม่มีคนเข้ามาแล้ว เท่านั้นชั่วโมง เราจึงต้องใช้ cronjob เพื่อ หลอกระบบว่ามีคนเข้ามาในเว็บเราเพื่อให้แอปของเราสามารถรันต่อไปได้</div><br />ถึงอย่างนั้นก็มีเว็บให้บริการ cronjob ฟรี เช่น&nbsp;<a href="https://www.setcronjob.com/" target="_blank">setcronjob.com</a>&nbsp;แต่ว่า เว็บ cronjob ฟรีนั้นโดยส่วนใหญ่ (น่าจะทั้งหมด) จะต้องเข้ามาต่ออายุใหม่ทุกเดือน ดังนั้นถ้าหากเราลืมต่ออายุเมื่อไรแอปเราจะเดี้ยงทันที บริการ host ฟรีก็มักไม่มี cronjob มาให้ ส่วน host ที่มี cronjob นั้นต้องเช่า แต่ทว่า คอนเซปส่วนตัวของผมคือ สร้างทุกอย่างจาก 0 บาท เพราะถ้าไม่กำไรก็มีแค่เท่าทุนไม่มีคำว่าขาดทุน จนกระทั้งผมได้รู้จักกับ <a href="https://www.parse.com/" target="_blank">parse.com&nbsp;</a><br /><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">เริ่มต้นการใช้งาน parse.com โดยเข้าไปที่หน้าเว็บ กด try it free แล้ว login with facebook ระบบจะเติมข้อมูลที่จำเป็นให้เรา</div><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-uN9Oo1RLBcw/VO_YbPKDr0I/AAAAAAAAYGE/7bpEu1l1sE0/s1600/loginwithfacebook.png" imageanchor="1" ><img border="0" src="https://2.bp.blogspot.com/-uN9Oo1RLBcw/VO_YbPKDr0I/AAAAAAAAYGE/7bpEu1l1sE0/s1600/loginwithfacebook.png" height="320" width="308" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">ระบบจะถามข้อมูลอีกเล็กน้อย รวมทั้งรายละเอียดของแอปแรกที่เราจะสร้าง กรอกให้เรียบร้อยจนกระทั้งถึงหน้าที่เข้า Dashboard ก็จะเป็นอันเสร็จพิธีการสมัคร</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-GdWnicjdqK0/VO_ZOJ5H_TI/AAAAAAAAYGM/Ht1q0BtaA_4/s1600/%E0%B9%80%E0%B8%AA%E0%B8%A3%E0%B9%87%E0%B8%88.png" imageanchor="1" ><img border="0" src="https://4.bp.blogspot.com/-GdWnicjdqK0/VO_ZOJ5H_TI/AAAAAAAAYGM/Ht1q0BtaA_4/s1600/%E0%B9%80%E0%B8%AA%E0%B8%A3%E0%B9%87%E0%B8%88.png" height="169" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">&nbsp;จากนั้นติดตั้งโปรแกรมของ Parse ลงในเครื่องครับ</div><div class="separator" style="clear: both; text-align: center;">สำหรับ windows ติดตั้งโปรแกรมได้ <a href="https://parse.com/downloads/windows/console/parse.zip" target="_blank">ที่นี่</a></div><div class="separator" style="clear: both; text-align: center;">สำหรับ Linux และ Mac ให้พิมพ์คำสั่งดังนี้</div><div class="separator" style="clear: both; text-align: center;"><br /></div><pre class="brush: js  language-js" data-number="" style="background: url(https://developer.cdn.mozilla.net/media/redesign/img/blueprint-dark.png) 50% 0% rgb(250, 251, 252); border-left-color: rgb(85, 138, 187); border-left-style: solid; border-width: 0px 0px 0px 6px; direction: ltr; margin-bottom: 20px; overflow: auto; padding: 1em 0px 1em 30px; position: relative; tab-size: 4; text-shadow: none; word-break: normal;"><span style="color: #0077aa; font-family: Consolas, Monaco, Andale Mono, monospace;"><span style="font-size: 14px; line-height: 19px;">curl -s https://www.parse.com/downloads/cloud_code/installer.sh | sudo   /bin/bash</span></span></pre><div class="separator" style="clear: both; text-align: center;">หลังจากนั้นสำหรับ windows ให้เปิด ParseConsole.exe แล้ว Mac และ Linux เปิด terminal ขึ้นมา</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">เตรียมโปรเจคด้วยคำสั่ง</div><div class="separator" style="clear: both; text-align: center;"><br /></div><pre class="brush: js  language-js" data-number="" style="background: url(https://developer.cdn.mozilla.net/media/redesign/img/blueprint-dark.png) 50% 0% rgb(250, 251, 252); border-left-color: rgb(85, 138, 187); border-left-style: solid; border-width: 0px 0px 0px 6px; direction: ltr; margin-bottom: 20px; overflow: auto; padding: 1em 0px 1em 30px; position: relative; tab-size: 4; text-shadow: none; word-break: normal;"><span style="color: #0077aa; font-family: Consolas, Monaco, Andale Mono, monospace;"><span style="font-size: 14px; line-height: 19px;">parse new &lt;ชื่อโฟลเดอร์ที่ใช้เก็บไฟล์&gt;</span></span></pre><div style="text-align: center;">จากนั้นเมื่อเข้าไปใน folder ที่เก็บไฟล์มาจะพบไฟล์เพิ่มขึ้นมาที่ cloud/main.js</div><div style="text-align: center;">เพิ่มบรรทัดดังนี้ครับ (แก้ชื่อฟังก์ชันเป็นฟังก์ชันคุณเอง และ urlที่ทำ cronjob ด้วย)&nbsp;</div><div style="text-align: center;"><br /></div><div style="text-align: center;"><pre class="brush: js  language-js" data-number="" style="background: url(https://developer.cdn.mozilla.net/media/redesign/img/blueprint-dark.png) 50% 0% rgb(250, 251, 252); border-left-color: rgb(85, 138, 187); border-left-style: solid; border-width: 0px 0px 0px 6px; direction: ltr; margin-bottom: 20px; overflow: auto; padding: 1em 0px 1em 30px; position: relative; tab-size: 4; text-align: start; text-shadow: none; word-break: normal;"><span style="color: #0077aa; font-family: Consolas, Monaco, Andale Mono, monospace;"><span style="font-size: 14px; line-height: 19px;">Parse.Cloud.job("ชื่อฟังก์ชัน",function(request, status){<br />  Parse.Cloud.httpRequest({url:"เว็บที่cronjob"}).then(function(response) {<br />      status.success("cronjob complete");<br />  });<br />});</span></span></pre></div><div style="text-align: center;">จากนั้นกดบันทึกไฟล์แล้วสั่ง&nbsp;</div><div style="text-align: center;"><br /></div><div><pre class="brush: js  language-js" data-number="" style="background: url(https://developer.cdn.mozilla.net/media/redesign/img/blueprint-dark.png) 50% 0% rgb(250, 251, 252); border-left-color: rgb(85, 138, 187); border-left-style: solid; border-width: 0px 0px 0px 6px; direction: ltr; margin-bottom: 20px; overflow: auto; padding: 1em 0px 1em 30px; position: relative; tab-size: 4; text-shadow: none; word-break: normal;"><span style="color: #0077aa; font-family: Consolas, Monaco, Andale Mono, monospace;"><span style="font-size: 14px; line-height: 19px;">parse deploy</span></span></pre></div><div style="text-align: center;">รอจนทำงานเสร็จ กลับมาที่เว็บ parse.com เลือก core &gt; job</div><div style="text-align: center;">จากนั้นกดปุ่ม&nbsp;Scheduled a Job ใต้ชื่อบัญชีเรา</div><div style="text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-x2sLjeacGMM/VO_c1Mk467I/AAAAAAAAYGY/_10vSDPrHwM/s1600/%E0%B8%AB%E0%B8%AB%E0%B8%AB.png" imageanchor="1" ><img border="0" src="https://2.bp.blogspot.com/-x2sLjeacGMM/VO_c1Mk467I/AAAAAAAAYGY/_10vSDPrHwM/s1600/%E0%B8%AB%E0%B8%AB%E0%B8%AB.png" height="113" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">แล้วตอนนี้ระบบจะให้เราตั้งเวลา cronjob แล้ว ตั้งเวลาที่คุณต้องการเลยครับ</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-WBt3kgoB3OE/VO_dASFyjEI/AAAAAAAAYGg/uVNyKHrszlA/s1600/jbo.png" imageanchor="1" ><img border="0" src="https://1.bp.blogspot.com/-WBt3kgoB3OE/VO_dASFyjEI/AAAAAAAAYGg/uVNyKHrszlA/s1600/jbo.png" height="202" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">แค่นี้เราก็จะมี cronjob ฟรีใช้ตลอดชีพแล้วครับ เอามาไว้ใช้กระตุ้น app idle ได้ชิวๆ</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-gQhDT4LfZ2o/VO_dJoGObkI/AAAAAAAAYGw/wBKd7NPqSTc/s1600/%E0%B8%97%E0%B8%B3%E0%B9%84%E0%B8%94%E0%B9%89%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%E0%B8%AB%E0%B8%B0.png" imageanchor="1" ><img border="0" src="https://1.bp.blogspot.com/-gQhDT4LfZ2o/VO_dJoGObkI/AAAAAAAAYGw/wBKd7NPqSTc/s1600/%E0%B8%97%E0%B8%B3%E0%B9%84%E0%B8%94%E0%B9%89%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%E0%B8%AB%E0%B8%B0.png" height="84" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">***หมายเหตุ ถ้าต้องการทำ cronjob มากกว่า 1 เว็บ เนื่องจากระบบ parse จำกัดบัญชีฟรี ได้เพียง 1 job เท่านั้น เราสามารถ ใช้ callback ของฟังก์ชัน&nbsp;Parse.Cloud.httpRequest เพื่อเรียก&nbsp;Parse.Cloud.httpRequest ฟังก์ชันต่อไปได้ แต่ในชั้นในสุดของ callback ต้องสั่ง status.success เสมอไม่เช่นนั้นในหน้า Job status จะขึ้นว่า failed และ เว็บที่ทำ cronjob ไป ต้องส่งค่า http.status กลับเป็น 200 เสมอไม่เช่นจะขึ้นว่า job failed ***</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div style="text-align: center;"><br /></div><div style="text-align: center;"><br /></div>
